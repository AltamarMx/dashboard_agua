--- 
title: "Consumo de agua UTEZ por baños"
author: "G. Barrios & G. Ramírez"
format: dashboard
--- 

```{python}
import plotly.express as px
import pandas as pd


f = "data/h20.csv"
agua = pd.read_csv(f,index_col=0,parse_dates=True)
agua_horaria = agua.resample("h").sum()
agua_horaria["total"] = agua_horaria["h"] + agua_horaria["m"]


agua_mensual = agua.resample("ME").sum()
agua_mensual["total"] = agua_mensual.sum(axis=1)
agua_mensual["por_h"] = round(agua_mensual.h/agua_mensual.total*100,ndigits=None).astype(int)
agua_mensual["por_m"] = round(agua_mensual.m/agua_mensual.total*100).astype(int)
```

# Fugas


```{python}

# Crear la figura
fig = px.line(agua_horaria, x=agua_horaria.index, 
            y=["h","m"],
              title='Consumo Horario de Agua',
              labels={'ts': '', 'Consumo': 'Consumo (L)'})

# Configurar la visualización
fig.update_layout(
    yaxis_title='Consumo (L)',
    hovermode='x unified'
)

# Mostrar la figura
# fig.show()

```


# Consumo


```{python}

fig = px.bar(agua_mensual, x=agua_mensual.index, y=['h', 'm'], title='Consumo mensual de H2O',
             labels={'value': 'Litros/mes', 'variable': 'Baño'},
             hover_data={'por_h', 'por_m',"total"})


# Actualizar el layout para mejorar la visualización
fig.update_layout(yaxis_title='Litros/Mes', xaxis_title='Fecha',
                  xaxis={'type': 'date'}, 
                  barmode='group')

```
